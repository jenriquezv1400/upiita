<html>
    <style>
        body {
               background-color: gray; 
            }
        tr:nth-child(even) {
                background-color: grey;
            }

        /* width */
        ::-webkit-scrollbar {
        width: 10px;
        }

        /* Track */
        ::-webkit-scrollbar-track {
        background: #f1f1f1; 
        }
        
        /* Handle */
        ::-webkit-scrollbar-thumb {
        background: #888; 
        }

        /* Handle on hover */
        ::-webkit-scrollbar-thumb:hover {
        background: #555; 
        }

    </style>

    <body > 
        <p >
            <span id="dateSpan" ></span>
            <input type="button" value="Copy Table" onClick="copytable('dataTable')">
            Language: <span id="languageSpan" ></span> <br>      
        </p> 
        <p id="languageDemo"></p>
        

        <table id="dataTable">
            <tr> 
                <th> Date</th>
                <th> Hour</th>
                <th> mass</th>
                <th> temp</th>
                <th> humidity</th>
            </tr> 
        </table>

    
        <script>
            let concatString = "";
            
            var appInventorInput = window.AppInventor.getWebViewString();
            if (concatString == ""){
                concatString = appInventorInput;
            }
            else{
                concatString = concatString.concat(",",appInventorInput);
            }
            
            // == Make data split array===
            const aInventorSplitArray = concatString.split(",");
            
            // ===== Change langugue  ============
            document.getElementById("languageSpan").innerHTML = aInventorSplitArray[aInventorSplitArray.length-1];
            if (aInventorSplitArray[aInventorSplitArray.length-1] == "Alem치n") {
               document.getElementById("languageDemo").innerHTML = "Good day!";
            }

            // ==== Array Repleced ======
            var arrayReplaced = [];

            for (var i = 0; i < aInventorSplitArray.length; i++){
                arrayReplaced[i] = aInventorSplitArray[i].replace(".",",");
            }

            // ===== Set date ============
            const d = new Date();
            let year =  d.getFullYear();
            let month = d.getMonth() + 1;
            let date =  d.getDate();
            let hour =  d.getHours();
            let minutes =  d.getMinutes() ;
            let seconds =  d.getSeconds() ;

            const dayConcact = year +"." + month + "."+ date;
            const hourConcact = hour + ":" +minutes + ":" + seconds

            // === Show curren date and hour ===
            document.getElementById("dateSpan").innerHTML = year +"." + month + "."+ date + " " + hour + ":" +minutes + ":" + seconds;

            // ====== Make componentsData object ======
            var componentsData = [];
            for (var i = 0; i < aInventorSplitArray.length/4; i++){
                if (aInventorSplitArray[aInventorSplitArray.length-1] == "Alem치n") {
                    componentsData[i] = {day: dayConcact, hour: hourConcact, Val_1: arrayReplaced[i*4], Val_2: arrayReplaced[i*4+1], Val_3: arrayReplaced[i*4+2]}
                }else{
                    componentsData[i] = {day: dayConcact, hour: hourConcact, Val_1: aInventorSplitArray[i*4], Val_2: aInventorSplitArray[i*4+1], Val_3: aInventorSplitArray[i*4+2]}
                }
            }
            
            // ====== Call Build table function ======
            BuildTable(componentsData);
            // === Bould table function Definition =====
            function BuildTable(data){
                var table = document.getElementById('dataTable');

                for (var i = 0; i < data.length; i++){
                        var row = 
                        `<tr>
                            <td>${data[i].day}</td>
                            <td>${data[i].hour}</td>    
                            <td>${data[i].Val_1}</td>
                            <td>${data[i].Val_2}</td>
                            <td>${data[i].Val_3}</td>
                        </tr>`;                                            
                        table.innerHTML += row;
                    }
                
                }
                
            

            // ====== Copy table function ======
            function copytable(el) {
                var urlField = document.getElementById(el)
                var range = document.createRange()
                range.selectNode(urlField)
                window.getSelection().addRange(range)
                document.execCommand('copy')
            }            
        </script>

        <!-- ================================ -->
        <!-- ============ Test code ========= -->
        <!-- ================================ -->

        <!-- Input Data -->
        <label for="stringInputLabel">Input String: </label>
        <input type="text" id="stringInput" name="stringInput">
        <button type="button" onclick="myFunction()">Up date</button>

        <!-- Show data -->
        <p>
            Language: <span id="languageSpan2" ></span> <br>
            StringBleDataMatrix: <span id="concatStringSpan" ></span> <br>
            Array Length: <span id="arrayLengthSpan" ></span> <br>
            ArrayReplaced: <span id="replaceSpan" ></span> <br>
            Object: <span id="objectSpan" ></span> <br>

            Date: <span id="daySpan" ></span> <br>
            Hour: <span id="hourSpan" ></span>
            Date length: <span id= "datelength" ></span>
        </p>

        <!-- Define table -->
        <table id="dataTable2"> 
            <tr>
                <th> Date</th>
                <th> Hour</th>
                <th> mass</th>
                <th> temp</th>
                <th> humidity</th>
            </tr>
        </table>

        <!-- ================================ -->
        <!-- ============ Test code script ========= -->
        <!-- ================================ -->

        <script>
            let concatStringTest = "";
            function myFunction() {
                // ======= Get data and split ===
                //1.2,2.3,3.4,Alem치n
                var stringInputValue = document.getElementById("stringInput").value;
                
                if (concatStringTest == ""){
                    concatStringTest = stringInputValue;
                }
                else{
                    concatStringTest = concatStringTest.concat(",",stringInputValue);
                }

                // === Show ble data concactenated string =======
                document.getElementById("concatStringSpan").innerHTML = concatStringTest;

                // == Make data split array===
                const array = concatStringTest.split(",");

                // ===== Change langugue  ============
                //var x = document.getElementById("lenguageSelect").value;
                //document.getElementById("languageSpan2").innerHTML = x;
                document.getElementById("languageSpan2").innerHTML = array[array.length-1];
                // ==== Array Repleced ======
                var arrayReplaced = [];

                for (var i = 0; i < array.length; i++){
                    arrayReplaced[i] = array[i].replace(".",",");
                }
                
                document.getElementById("replaceSpan").innerHTML = arrayReplaced;
                
                // ===== Set date ============
                const d = new Date();
                let year =  d.getFullYear();
                let month = d.getMonth() + 1;
                let date =  d.getDate();
                let hour =  d.getHours();
                let minutes =  d.getMinutes();
                let seconds =  d.getSeconds();
                
                const dayConcact = year +"." + month + "."+ date;
                const hourConcact = hour + ":" +minutes + ":" + seconds

                document.getElementById("daySpan").innerHTML = dayConcact ;
                document.getElementById("hourSpan").innerHTML = hourConcact;

                // ====== Make componentsData object ======

                document.getElementById("arrayLengthSpan").innerHTML = array.length/4;
                
                var componentsData2 = [];
                for (var i = 0; i < array.length/4; i++){
                    if (array[array.length-1] == "Alem치n") {
                        componentsData2[i] = {day: dayConcact, hour: hourConcact, Val_1: arrayReplaced[i*4], Val_2: arrayReplaced[i*4+1], Val_3: arrayReplaced[i*4+2]}
                    }else{
                        componentsData2[i] = {day: dayConcact, hour: hourConcact, Val_1: array[i*4], Val_2: array[i*4+1], Val_3: array[i*4+2]};
                    } 
                }

                document.getElementById("objectSpan").innerHTML = componentsData2[array.length/4-1].day + " "+componentsData2[array.length/4-1].hour;
                // ====== Call Build table function ======
                BuildTable2(componentsData2);
                // === Build table function Definition  =====
                function BuildTable2(data){
                    var table2 = document.getElementById('dataTable2');
                    document.getElementById("datelength").innerHTML = data.length;
                    
                    for (var i = 0; i < data.length; i++){
                        var row2 = 
                        `<tr>
                            <td>${data[i].day}</td>
                            <td>${data[i].hour}</td>    
                            <td>${data[i].Val_1}</td>
                            <td>${data[i].Val_2}</td>
                            <td>${data[i].Val_3}</td>
                        </tr>`;                                            
                    } 
                    table2.innerHTML += row2;
                }
            }
        </script>
    </body>
</html>